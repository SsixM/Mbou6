<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–£—Ä–æ–∫–∏</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <button id="theme-toggle" class="theme-toggle">üåô –¢—ë–º–Ω–∞—è —Ç–µ–º–∞</button>
        <div id="main-page">
            <h1>–£—Ä–æ–∫–∏</h1>
            <div class="filters">
                <select id="subjectFilter">
                    <option value="all">–í—Å–µ –ø—Ä–µ–¥–º–µ—Ç—ã</option>
                    <option value="–†—É—Å—Å–∫–∏–π —è–∑—ã–∫">–†—É—Å—Å–∫–∏–π —è–∑—ã–∫</option>
                    <option value="–ë–∏–æ–ª–æ–≥–∏—è">–ë–∏–æ–ª–æ–≥–∏—è</option>
                    <option value="–ê–ª–≥–µ–±—Ä–∞">–ê–ª–≥–µ–±—Ä–∞</option>
                    <option value="–§–∏–∑–∏–∫–∞">–§–∏–∑–∏–∫–∞</option>
                    <option value="–ò—Å—Ç–æ—Ä–∏—è">–ò—Å—Ç–æ—Ä–∏—è</option>
                    <option value="–ì–µ–æ–º–µ—Ç—Ä–∏—è">–ì–µ–æ–º–µ—Ç—Ä–∏—è</option>
                    <option value="–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è">–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è</option>
                    <option value="–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞">–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞</option>
                    <option value="–ì–µ–æ–≥—Ä–∞—Ñ–∏—è">–ì–µ–æ–≥—Ä–∞—Ñ–∏—è</option>
                    <option value="–•–∏–º–∏—è">–•–∏–º–∏—è</option>
                    <option value="–§–∏–∑–∫—É–ª—å—Ç—É—Ä–∞">–§–∏–∑–∫—É–ª—å—Ç—É—Ä–∞</option>
                    <option value="–ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞">–ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞</option>
                    <option value="–û–ë–ñ">–û–ë–ñ</option>
                    <option value="–ê–Ω–≥–ª–∏–π—Å–∫–∏–π —è–∑—ã–∫">–ê–Ω–≥–ª–∏–π—Å–∫–∏–π —è–∑—ã–∫</option>
                </select>
                <input type="date" id="dateFilter">
            </div>
            <div class="lessons" id="lessons"></div>
        </div>
        <div id="lesson-page" class="hidden">
            <button id="back-button" class="back-button">‚Üê –ù–∞–∑–∞–¥</button>
            <h2 id="lesson-title"></h2>
            <p id="lesson-subject"></p>
            <p id="lesson-date"></p>
            <p id="lesson-description"></p>
            <div id="lesson-content"></div>
            <button id="raw-text-button" class="raw-text-button">–ü–æ–∫–∞–∑–∞—Ç—å —Å—ã—Ä–æ–π —Ç–µ–∫—Å—Ç</button>
            <div id="raw-text" class="hidden"></div>
        </div>
    </div>

    <script>
        let lessons = [];

        // –ó–∞–≥—Ä—É–∑–∫–∞ —É—Ä–æ–∫–æ–≤ –∏–∑ JSON
        fetch('lessons.json')
            .then(response => response.json())
            .then(data => {
                lessons = data;
                renderLessons(lessons);
            })
            .catch(error => console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —É—Ä–æ–∫–æ–≤:', error));

        function renderLessons(filteredLessons) {
            const lessonsContainer = document.getElementById('lessons');
            lessonsContainer.innerHTML = '';
            filteredLessons.forEach((lesson, index) => {
                const card = document.createElement('div');
                card.className = 'lesson-card';
                card.dataset.index = index;
                card.innerHTML = `
                    <h3>${lesson.title}</h3>
                    <p>–ü—Ä–µ–¥–º–µ—Ç: ${lesson.subject}</p>
                    <p>–î–∞—Ç–∞: ${lesson.date}</p>
                    <p>${lesson.description}</p>
                `;
                card.addEventListener('click', () => showLesson(index));
                lessonsContainer.appendChild(card);
            });
        }

        function filterLessons() {
            const subject = document.getElementById('subjectFilter').value;
            const date = document.getElementById('dateFilter').value;
            const filtered = lessons.filter(lesson => {
                const matchSubject = subject === 'all' || lesson.subject === subject;
                const matchDate = !date || lesson.date === date;
                return matchSubject && matchDate;
            });
            renderLessons(filtered);
        }

        function showLesson(index) {
            const lesson = lessons[index];
            document.getElementById('main-page').classList.add('hidden');
            document.getElementById('lesson-page').classList.remove('hidden');
            document.getElementById('lesson-title').textContent = lesson.title;
            document.getElementById('lesson-subject').textContent = `–ü—Ä–µ–¥–º–µ—Ç: ${lesson.subject}`;
            document.getElementById('lesson-date').textContent = `–î–∞—Ç–∞: ${lesson.date}`;
            document.getElementById('lesson-description').textContent = lesson.description;
            document.getElementById('lesson-content').innerHTML = lesson.content;
            document.getElementById('raw-text').innerHTML = lesson.rawText;
            document.getElementById('raw-text-button').onclick = () => {
                const rawTextDiv = document.getElementById('raw-text');
                rawTextDiv.classList.toggle('hidden');
                document.getElementById('raw-text-button').textContent = rawTextDiv.classList.contains('hidden') ? '–ü–æ–∫–∞–∑–∞—Ç—å —Å—ã—Ä–æ–π —Ç–µ–∫—Å—Ç' : '–°–∫—Ä—ã—Ç—å —Å—ã—Ä–æ–π —Ç–µ–∫—Å—Ç';
            };
        }

        document.getElementById('subjectFilter').addEventListener('change', filterLessons);
        document.getElementById('dateFilter').addEventListener('input', filterLessons);
        document.getElementById('back-button').addEventListener('click', () => {
            document.getElementById('lesson-page').classList.add('hidden');
            document.getElementById('main-page').classList.remove('hidden');
        });

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–µ–º—ã
        const themeToggle = document.getElementById('theme-toggle');
        themeToggle.addEventListener('click', () => {
            document.body.classList.toggle('dark-theme');
            themeToggle.textContent = document.body.classList.contains('dark-theme') ? '‚òÄÔ∏è –°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞' : 'üåô –¢—ë–º–Ω–∞—è —Ç–µ–º–∞';
            localStorage.setItem('theme', document.body.classList.contains('dark-theme') ? 'dark' : 'light');
        });

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–æ–π —Ç–µ–º—ã
        if (localStorage.getItem('theme') === 'dark') {
            document.body.classList.add('dark-theme');
            themeToggle.textContent = '‚òÄÔ∏è –°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞';
        }
    </script>
</body>
</html>